# YaMDB Final


![example workflow](https://github.com/mutedop/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)



# Docker-compose проекта YamDB запушен на ВМ
```http://178.154.218.210/admin/```

_________________________
#### _Сервис, на котором могут делиться отзывами о различных фильмах, книгах, музыке. Выставление рейтинга._
_________________________
### Реализация ролей пользователей на сервисе
##### ```Пользователь (Анонимный)``` - просмотр контента
##### ```Пользователь (Зарегистрированный)``` - просмотр контента, написание/удаление своих отзывов, коментирование, выставление рейтинга.
##### ```Модератор``` - дополнительно к Пользователь (Зарегистрированный) имеет право на удаление/редактирование отзывов и комментариев пользователей Сервиса
##### ```Администратор``` - полный комплект прав для управления Сервисом. Может назначать роли пользователей. Создает и удаляет категории/жанры.
###### Документацию к проекту можно посмотреть на странице ```/redoc```

_________________________

### Работа с Docker
_________________________

В корневой папке проекта необходимо создать файл .env (в случае если его нет) и заполнить переменные окружения:
> Как пример файла:\
> DB_ENGINE=django.db.backends.postgresql\
> DB_NAME=postgres\
> POSTGRES_USER=postgres\
> POSTGRES_PASSWORD=postgres\
> DB_HOST=db\
> DB_PORT=5432

Запустим сборку контейнеров Docker:
> docker-compose up

или

> docker-compose up -d --build

что позволит развернуть контейнер в фоновом режиме

По окончании работы docker-compose сообщит, что контейнеры собраны и запущены

#### Дополним контейнер

> docker-compose exec web python manage.py makemigrations --noinput\
> docker-compose exec web python manage.py migrate --noinput\
> docker-compose exec web python manage.py createsuperuser\
> docker-compose exec web python manage.py collectstatic --no-input

Для остановки контейнера:

> docker-compose down

Заполнить базу

> docker-compose exec web python manage.py dumpdata > fixtures.json

```http://127.0.0.1/admin/```

__________________________
### Стек технологий
__________________________

- Python 3
- Docker
- Gunicorn
- Nginx
- PostgreSQL
- Django REST Framework
- Simple JWT
- Яндекс.Облако

_________________________

### Регистрация API YamDB
_________________________

##### Токен JWT используется в качестве механизма аутентификации, который можно получить после авторизации по электронной почте.
##### POST-запрос с ```email``` на /api/ve/auth/email/
##### Сервис отправит письмо с кодом ```confirmation_code```
##### POST-запрос на /api/v1/auth/token/ с ```email``` + ```confirmation_code```
##### Сервис вернет JWT-token
> Единоразовая процедура для регистрации пользователя
> после получения токена, можно работать с API, отправляя данный токен в заголовке запроса.
###### Документацию к проекту можно посмотреть на странице ```/redoc```
_________________________

### Установка YamDB
_________________________

##### Склонировать репозиторий
##### Создать и запустить ```venv```
##### Установить зависимости ```requirements.txt```
##### Провести ```migrations```
##### Задать ```superuser``` django
##### Запустить Сервис ```runserver```
###### Документацию к проекту можно посмотреть на странице ```/redoc```
